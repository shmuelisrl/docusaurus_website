{"version":3,"sources":["../src/Configuration.js"],"names":["Configuration","options","server","nodes","host","port","path","protocol","cacheSearchResultsForSeconds","additionalSearchParameters","query_by","queryBy","sort_by","sortBy","highlight_full_fields","highlightFullFields","geoLocationField","collectionSpecificSearchParameters","Object","keys","forEach","collection","params","key","undefined","values","some","c","console","warn","length","Error"],"mappings":"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","sourcesContent":["\"use strict\";\n\nexport class Configuration {\n  constructor(options = {}) {\n    this.server = options.server || {\n      nodes: [\n        {\n          host: \"localhost\",\n          port: \"8108\",\n          path: \"\",\n          protocol: \"http\",\n        },\n      ],\n    };\n\n    this.server.cacheSearchResultsForSeconds = this.server.cacheSearchResultsForSeconds ?? 2 * 60;\n\n    this.additionalSearchParameters = options.additionalSearchParameters ?? {};\n\n    this.additionalSearchParameters.query_by =\n      this.additionalSearchParameters.queryBy ?? this.additionalSearchParameters.query_by ?? \"\";\n\n    this.additionalSearchParameters.sort_by =\n      this.additionalSearchParameters.sortBy ?? this.additionalSearchParameters.sort_by ?? \"\";\n\n    this.additionalSearchParameters.highlight_full_fields =\n      this.additionalSearchParameters.highlightFullFields ??\n      this.additionalSearchParameters.highlight_full_fields ??\n      this.additionalSearchParameters.query_by;\n\n    this.geoLocationField = options.geoLocationField ?? \"_geoloc\";\n\n    this.collectionSpecificSearchParameters = options.collectionSpecificSearchParameters ?? {};\n\n    Object.keys(this.collectionSpecificSearchParameters).forEach((collection) => {\n      const params = this.collectionSpecificSearchParameters[collection];\n      params.query_by = params.queryBy ?? params.query_by;\n      params.sort_by = params.sortBy ?? params.sort_by;\n      params.highlight_full_fields =\n        params.highlightFullFields ??\n        params.highlight_full_fields ??\n        this.additionalSearchParameters.highlight_full_fields ??\n        params.query_by;\n\n      // Remove undefined values\n      Object.keys(params).forEach((key) => (params[key] === undefined ? delete params[key] : {}));\n    });\n  }\n\n  validate() {\n    // Warn if camelCased parameters are used, suggest using snake_cased parameters instead\n    if (\n      this.additionalSearchParameters.queryBy ||\n      Object.values(this.collectionSpecificSearchParameters).some((c) => c.queryBy)\n    ) {\n      console.warn(\n        \"[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version.\" +\n          \" We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js.\"\n      );\n    }\n\n    /*\n     * Either additionalSearchParameters.query_by needs to be set, or\n     *   All collectionSpecificSearchParameters need to have query_by\n     *\n     * */\n    if (\n      this.additionalSearchParameters.query_by.length === 0 &&\n      (Object.keys(this.collectionSpecificSearchParameters).length === 0 ||\n        Object.values(this.collectionSpecificSearchParameters).some((c) => (c.query_by || \"\").length === 0))\n    ) {\n      throw new Error(\n        \"[typesense-instantsearch-adapter] Missing parameter: Either additionalSearchParameters.query_by needs to be set, or all collectionSpecificSearchParameters need to have .query_by set\"\n      );\n    }\n  }\n}\n"],"file":"Configuration.js"}